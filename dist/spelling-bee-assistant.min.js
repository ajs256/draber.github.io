!function(){"use strict";const e=({tag:t="div",text:a="",attributes:r={},style:n={},data:s={},events:o={},classNames:i=[],cellData:l=[],cellTag:d="td"}={})=>{if("tr"===t&&l.length)return(({classNames:t=[],events:a={},cellData:r=[],cellTag:n="td"}={})=>{const s=e({tag:"tr",classNames:t,events:a});return r.forEach((t=>{s.append(e({tag:n,text:t}))})),s})({classNames:i,events:o,cellData:l,cellTag:d});if("input"===t&&"checkbox"===r.type&&a)return(({text:t="",classNames:a=[],attributes:r={},events:n={}}={})=>{const s=e({tag:"input",attributes:r,events:n}),o=e({tag:"label",text:t,classNames:a});return o.prepend(s),o})({text:a,classNames:i,attributes:r,events:o});const p=document.createElement(t);for(const[e,t]of Object.entries(n))p.style[e]=t;i.length&&p.classList.add(...i),Array.isArray(a)?p.append(e({tag:a[1],text:a[0]})):p.textContent=a;for(const[e,t]of Object.entries(r))""!==t&&p.setAttribute(e,t);for(const[e,t]of Object.entries(s))p.dataset[e]=t;for(const[e,t]of Object.entries(o))p.addEventListener(e,t,!1);return p};var t={$:(e,t=null)=>"string"==typeof e?(t||document).querySelector(e):e||null,$$:(e,t=null)=>[].slice.call((t||document).querySelectorAll(e)),create:e};let a=[];var r={add:(e,t,r)=>(e.observe(t,r),a.push(e)),remove:e=>(e.disconnect(),a=a.filter((function(t){return t!==e})),a.length),removeAll:function(){return a.forEach((e=>{this.remove(e)})),a.length}},n="sba";const s={label:"Spelling Bee Assistant",title:"Assistant",url:"https://spelling-bee-assistant.app/",prefix:n,repo:"draber/draber.github.io.git",version:"2.0.0",options:JSON.parse(localStorage.getItem("sba-settings")||"{}")};var o=e=>{let t=Object.create(s);for(let a of e.split(".")){if(!t[a])return;t=t[a]}return t},i=(e,t)=>{const a=e.split("."),r=a.pop();let n=s;for(let e of a){if(n[e]||(n[e]={}),"[object Object]"===!Object.prototype.toString.call(n))return console.error(`${e} is not of the type Object`),!1;n=n[e]}n[r]=t,localStorage.setItem("sba-settings",JSON.stringify(s.options))};const l=(e,t="c")=>{switch(t){case"c":return(e=>e.replace(/[_-]+([a-z])/g,(e=>e[1].toUpperCase())))(o("prefix")+"_"+e);case"d":return(e=>e.match(/([A-Z])/g).reduce(((e,t)=>e.replace(new RegExp(t),"-"+t.toLowerCase())),e).substring(e.slice(0,1).match(/([A-Z])/g)?1:0))(o("prefix")+e.charAt(0).toUpperCase()+e.slice(1));default:return e}};let d;const p=(e,a)=>{d.foundTerms=[],d.foundPangrams=[],t.$$("li",a).forEach((e=>{const t=e.textContent;d.foundTerms.push(t),d.pangrams.includes(t)&&(d.foundPangrams.push(t),e.classList.add("sb-pangram"))})),d.remainders=d.answers.filter((e=>!d.foundTerms.includes(e))),e.dispatchEvent(new Event(l("updateComplete")))};var c=(e,t)=>{d={answers:window.gameData.today.answers,pangrams:window.gameData.today.pangrams,foundTerms:[],foundPangrams:[],remainders:[]},p(e,t),e.addEventListener(l("update"),(()=>{p(e,t)}))},g=e=>d[e],b=e=>d[e].length,u=e=>{const t=d[e];let a=0;return t.forEach((e=>{d.pangrams.includes(e)?a+=e.length+7:e.length>4?a+=e.length:a+=1})),a};let m;const f="noUi",v=e=>!1===o(`options.${e}.v`),h=(e,t,a)=>!v(t)&&(e!==f?e instanceof HTMLElement:a),x=({app:e,key:a,plugin:n,title:s="",optional:o=!1,defaultState:d=!0,observer:p,target:c=null}={})=>{n!==f&&(c=c||t.$(`[data-plugin="${a}"]`,e)||(()=>{const r=t.create({data:{plugin:a}});return e.append(r),r})(),d&&c.append(n)),o&&i(`options.${a}`,{t:s,v:h(n,a,d)});const g=l(a);return e.addEventListener(g,(t=>{t.detail.enabled?x({app:e,plugin:n,key:a,title:s,optional:o}):k({plugin:n,key:a,title:s})})),p&&r.add(p.observer,p.target,p.args),n},k=({plugin:e,key:t="",title:a="",observer:n}={})=>(e instanceof HTMLElement&&e.remove(),i(`options.${t}.v`,!1),n&&r.remove(n.observer),null);var y={add:x,remove:k,isDisabled:v,getState:h,noUi:f};let w=null;const E="Score so far",L="scoreSoFar",$=t.create({tag:"tbody"}),z=()=>{$.innerHTML="",[["Words",b("foundTerms"),b("remainders"),b("answers")],["Points",u("foundTerms"),u("remainders"),u("answers")]].forEach((e=>{$.append(t.create({tag:"tr",cellData:e}))}))};var T={add:(e,a)=>{if(!y.isDisabled(L)){w=t.create({tag:"details",text:[E,"summary"],attributes:{open:!0}});const a=t.create({tag:"table",classNames:["pane"]}),r=t.create({tag:"thead"});r.append(t.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]})),a.append(r),a.append($),z(),w.append(a),e.addEventListener(l("updateComplete"),(()=>{z()}))}return y.add({app:e,plugin:w,key:L,title:E,optional:true})},remove:()=>y.remove({plugin:w,key:L,title:E})};let C;const N="Set-up",_="setUp";var S={add:(e,a)=>{C=t.create({tag:"details",text:[N,"summary"]});const r=t.create({tag:"ul",classNames:["pane"]});return C.append(r),e.addEventListener(l("launchComplete"),(()=>{((e,a)=>{for(const[r,n]of Object.entries(o("options"))){const s=t.create({tag:"li"}),o=t.create({tag:"input",text:n.t,attributes:{type:"checkbox",name:r},events:{click:function(t){e.dispatchEvent(new CustomEvent(l(r),{detail:{enabled:t.target.checked}}))}}});t.$("input",o).checked=n.v,s.append(o),a.append(s)}})(e,r)})),y.add({app:e,plugin:C,key:_,title:N,optional:false})},remove:()=>y.remove({plugin:C,key:_,title:N})};let M;const D="Spill the beans",O="spillTheBeans";let j;var A={add:(e,a)=>{if(!y.isDisabled(O)){j=((e,t)=>({observer:new MutationObserver((t=>{e.dispatchEvent(new CustomEvent(l("spill"),{detail:{text:t.pop().target.textContent.trim()}}))})),target:t,args:{childList:!0}}))(e,t.$(".sb-hive-input-content",a));const r=t.create({classNames:["pane"]}),n=t.create({text:"Watch me while you type!",classNames:["spill-title"]}),s=t.create({text:"😐",classNames:["spill"]});r.append(n),r.append(s),M=t.create({tag:"details",text:[D,"summary"]}),e.addEventListener("sbaSpill",(e=>{var t;s.textContent=(t=e.detail.text)?g("remainders").filter((e=>e.startsWith(t))).length?"🙂":"🙁":"😐"})),M.append(r)}return y.add({app:e,plugin:M,key:O,title:D,optional:true,observer:j})},remove:()=>y.remove({plugin:M,key:O,title:D,observer:j})};let B;const F="Spoilers",H="spoilers",Y=t.create({tag:"tbody"}),P=()=>{Y.innerHTML="",(()=>{const e={},t=b("pangrams"),a=b("foundPangrams"),r=[["Pangrams",a,t-a,t]];g("answers").forEach((t=>{e[t.length]=e[t.length]||{found:0,missing:0,total:0},g("foundTerms").includes(t)?e[t.length].found++:e[t.length].missing++,e[t.length].total++}));let n=Object.keys(e);return n.sort(((e,t)=>e-t)),n.forEach((t=>{r.push([t+" "+(t>1?"letters":"letter"),e[t].found,e[t].missing,e[t].total])})),r})().forEach((e=>{Y.append(t.create({tag:"tr",cellData:e}))}))};var R={add:(e,a)=>{if(!y.isDisabled(H)){B=t.create({tag:"details",text:[F,"summary"]});const a=t.create({tag:"table",classNames:["pane"]}),r=t.create({tag:"thead"});r.append(t.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]})),a.append(r),a.append(Y),P(),B.append(a),e.addEventListener(l("updateComplete"),(()=>{P()}))}return y.add({app:e,plugin:B,key:H,title:F,optional:true})},remove:()=>y.remove({plugin:B,key:H,title:F})};let U;const I="header";let W,X=!1;const q=(e,t)=>{[e,t].forEach((e=>{e.addEventListener("dragover",(e=>{e.preventDefault()}))})),e.addEventListener("dragstart",(e=>{if(!X)return e.preventDefault(),!1;e.target.style.opacity=".2",W=((e,t)=>{const a=t.getBoundingClientRect(),r=e.target.getBoundingClientRect(),n=a.top+window.pageYOffset,s=U.parentElement.getBoundingClientRect(),o=a.height-(a.top-r.top)-(r.top-s.top)-s.height;return{maxL:document.documentElement.clientWidth-r.width,minT:n,maxT:n+o,offX:e.clientX-r.x,offY:e.clientY-r.y,margT:parseInt(getComputedStyle(e.target).marginTop,10)}})(e,t)}),!1),e.addEventListener("dragend",(e=>{Object.assign(e.target.style,(e=>{let t=Math.max(0,e.clientX-W.offX);t=Math.min(t,W.maxL)+"px";let a=Math.max(W.minT,e.clientY+window.pageYOffset-W.margT-W.offY);return a=Math.min(a,W.maxT)+"px",{left:t,top:a}})(e)),e.target.style.opacity="1"}))};var J={add:(e,a)=>{U=t.create();const r=t.create({text:o("title"),attributes:{title:"Hold the mouse down to drag"},classNames:["dragger"]});U.append(r);const n=t.create({tag:"span",text:"×",attributes:{title:"Close"},classNames:["closer"],events:{click:()=>{e.dispatchEvent(new Event(l("destroy")))}}}),s=t.create({tag:"span",attributes:{title:"Minimize"},classNames:["minimizer"],events:{click:()=>{e.classList.toggle("minimized")}}});return e.addEventListener("pointerdown",(e=>{X=!!e.target.closest('[data-plugin="header"]')})),e.addEventListener("pointerup",(e=>{X=!1})),U.append(s),U.append(n),q(e,a),y.add({app:e,plugin:U,key:I})},remove:()=>y.remove({plugin:U,key:I,title:"Header"})};let Z;const Q="Surrender",G="surrender",K=e=>{r.removeAll(),g("remainders").forEach((a=>{e.append((e=>{const a=t.create({tag:"li",classNames:g("pangrams").includes(e)?["sb-anagram","sb-pangram"]:["sb-anagram"]});return a.append(t.create({tag:"a",text:e,attributes:{href:`https://www.google.com/search?q=${e}`,target:"_blank"}})),a})(a))}))};var V={add:(e,a)=>{if(!y.isDisabled(G)){Z=t.create({tag:"details",text:[Q,"summary"]});const e=t.create({classNames:["pane"]}),r=t.create({tag:"button",classNames:["hive-action"],text:"Display answers",attributes:{type:"button"},events:{click:function(){K(t.$(".sb-wordlist-items",a))}}});e.append(r),Z.append(e)}return y.add({app:e,plugin:Z,key:G,title:Q,optional:true})},remove:()=>y.remove({plugin:Z,key:G,title:Q})};let ee;const te="Steps to success",ae="stepsToSuccess";let re;const ne={},se=(e,a)=>{const n=u("answers");t.$$(".sb-modal-list li",e).forEach((e=>{const t=e.textContent.match(/([^\(]+) \((\d+)\)/);ne[t[1]]=parseInt(t[2],10)})),ne["Queen Bee"]=n,e.parentElement.style.opacity=0,t.$(".sb-modal-close",e).click(),r.remove(re.observer),oe(a)},oe=e=>{e.innerHTML="";const a=Object.values(ne).filter((e=>e<=u("foundTerms"))).pop();for(const[r,n]of Object.entries(ne))e.append(t.create({tag:"tr",classNames:n===a?["current"]:[],cellTag:"td",cellData:[r,n]}))};var ie={add:(e,a)=>{if(!y.isDisabled(ae)){ee=t.create({tag:"details",text:[te,"summary"]});const n=t.create({tag:"table",classNames:["pane"]}),s=t.create({tag:"tbody"});n.append(s),ee.addEventListener("toggle",(()=>{if(ee.open&&!s.hasChildNodes()){const e=t.$(".sb-modal-wrapper");re=((e,a)=>({observer:new MutationObserver((r=>{const n=r.pop().target,s=t.$(".sb-modal-title",n);s&&"Rankings"===s.textContent.trim()&&(e.parentElement.style.opacity=0,se(e,a))})),target:e,args:{childList:!0}}))(e,s),r.add(re.observer,re.target,re.args),t.$(".sb-progress",a).click()}})),ee.append(n),e.addEventListener(l("updateComplete"),(()=>{oe(s)}))}return y.add({app:e,plugin:ee,key:ae,title:te,optional:true})},remove:()=>y.remove({plugin:ee,key:ae,title:te})};let le;const de="footer";var pe={add:(e,a)=>(le=t.create({tag:"a",text:`${o("label")} ${o("version")}`,attributes:{href:o("url"),target:"_blank"}}),y.add({app:e,key:de,plugin:le})),remove:()=>y.remove({plugin:le,key:de,title:"Footer"})};let ce=y.noUi;const ge="darkMode";var be={add:(e,a)=>(e.addEventListener(l(ge),(e=>{e.detail.enabled?(t.$("body").classList.add(l("dark","d")),i("options.darkMode.v",!0)):(t.$("body").classList.remove(l("dark","d")),i("options.darkMode.v",!1))})),e.dispatchEvent(new CustomEvent(l(ge),{detail:{enabled:y.getState(ce,ge,false)}})),y.add({app:e,plugin:ce,key:ge,title:"Dark Mode",optional:true,defaultState:false})),remove:()=>{app.dispatchEvent(new CustomEvent(l(ge),{detail:{enabled:!1}}))}};let ue;const me="styles",fe=()=>y.remove({plugin:ue,key:me,title:"Styles"});var ve={add:(e,a)=>{ue=t.create({tag:"style",text:'\ufeff.pz-game-field{background:inherit;color:inherit}.sb-wordlist-items .sb-pangram{border-bottom:2px #f8cd05 solid}.sb-wordlist-items .sb-anagram a{color:#888}.sba-dark{background:#111;color:#eee}.sba-dark .sba{background:#111}.sba-dark .sba summary{background:#252525;color:#eee}.sba-dark .pz-nav__hamburger-inner,.sba-dark .pz-nav__hamburger-inner::before,.sba-dark .pz-nav__hamburger-inner::after{background-color:#eee}.sba-dark .pz-nav{width:100%;background:#111}.sba-dark .pz-nav__logo{filter:invert(1)}.sba-dark .sb-modal-scrim{background:rgba(17,17,17,.85);color:#eee}.sba-dark .pz-modal__title{color:#eee}.sba-dark .sb-modal-frame,.sba-dark .pz-modal__button.white{background:#111;color:#eee}.sba-dark .pz-modal__button.white:hover{background:#393939}.sba-dark .sb-message{background:#393939}.sba-dark .sb-progress-marker .sb-progress-value,.sba-dark .hive-cell.center .cell-fill{background:#f7c60a;fill:#f7c60a;color:#111}.sba-dark .sb-input-bright{color:#f7c60a}.sba-dark .hive-cell.outer .cell-fill{fill:#393939}.sba-dark .cell-fill{stroke:#111}.sba-dark .cell-letter{fill:#eee}.sba-dark .hive-cell.center .cell-letter{fill:#111}.sba-dark .hive-action:not(.hive-action__shuffle){background:#111;color:#eee}.sba-dark .hive-action__shuffle{filter:invert(100%)}.sba-dark *:not(.hive-action__shuffle):not(.sb-pangram){border-color:#333 !important}.sba{position:absolute;width:200px;background:inherit;box-sizing:border-box;z-index:3;margin:16px 0;padding:0 10px 5px;background:#fff;border-width:1px;border-color:#dcdcdc;border-radius:6px;border-style:solid}.sba *,.sba *:before,.sba *:after{box-sizing:border-box}.sba *:focus{outline:0}.sba .dragger{font-weight:bold;cursor:move;line-height:32px}.sba .closer,.sba .minimizer{font-size:18px;font-weight:bold;position:absolute;top:0;line-height:32px;padding:0 10px;cursor:pointer}.sba .closer{right:0}.sba .minimizer{right:16px}.sba .minimizer:before{content:"－"}.sba.minimized details{display:none}.sba.minimized .minimizer:before{content:"＋"}.sba details{font-size:90%;margin-bottom:1px}.sba details[open] summary:before{content:"－"}.sba summary{line-height:24px;padding:0 15px 0 25px;background:#f8cd05;cursor:pointer;list-style:none;position:relative}.sba summary::-webkit-details-marker{display:none}.sba summary:before{content:"＋";position:absolute;left:8px}.sba .hive-action{margin:0 auto;display:block;font-size:100%;white-space:nowrap}.sba .pane{border:1px solid #dcdcdc;border-top:none;border-collapse:collapse;width:100%;font-size:85%;margin-bottom:4px}.sba tr:first-of-type td,.sba tr:first-of-type th{border-top:none}.sba tr td:first-of-type{text-align:left}.sba tr.current{font-weight:bold;border-bottom:2px solid #f8cd05}.sba th,.sba td{border:1px solid #dcdcdc;white-space:nowrap}.sba thead th{text-align:center;padding:4px 0}.sba tbody th{text-align:right}.sba tbody td{text-align:center;padding:4px 6px}.sba [data-plugin=footer] a{color:currentColor;opacity:.6;font-size:10px;text-align:right;display:block;padding-top:8px}.sba [data-plugin=footer] a:hover{opacity:.8;text-decoration:underline}.sba .spill-title{padding:10px 6px 0px;text-align:center}.sba .spill{text-align:center;padding:17px 0;font-size:280%}.sba ul.pane{padding:5px}.sba [data-plugin=surrender] .pane{padding:10px 5px}.sba label{cursor:pointer;position:relative;line-height:19px}.sba label input{position:relative;top:2px;margin:0 10px 0 0}\n'.replace(/(\uFEFF|\\n)/gu,"")}),e.addEventListener(l("destroy"),(()=>{fe()}));const r=t.$("head");return y.add({app:e,plugin:ue,key:me,target:r})},remove:fe};const he=t.$("#pz-game-root"),xe=function(e){if(!e||!window.gameData)return console.info("This bookmarklet only works on https://www.nytimes.com/puzzles/spelling-bee"),!1;const a=t.$(".sb-content-box",e).getBoundingClientRect(),n=t.$(".sb-wordlist-items",e),s={};s[l("destroy")]=e=>{r.removeAll(),e.target.remove()};const i=t.create({attributes:{draggable:!0},style:{left:a.right+10+"px",top:a.top+window.pageYOffset+"px"},data:{id:o("repo")},classNames:[o("prefix")],events:s});return c(i,n),m=((e,t)=>({observer:new MutationObserver((t=>{e.dispatchEvent(new CustomEvent(l("update"),{detail:{text:t.pop().addedNodes[0]}}))})),target:t,args:{childList:!0}}))(i,n),r.add(m.observer,m.target,m.args),i}(he);if(xe){const e=t.$(`[data-id="${o("repo")}"]`);e&&e.dispatchEvent(new Event(l("destroy"))),o("prefix"),o("options.darkMode"),o("options.darkMode.v"),o("options.darkMode.x"),[ve,be,J,T,R,A,ie,V,S,pe].forEach((e=>{e.add(xe,he)})),t.$("body").append(xe),xe.dispatchEvent(new Event(l("launchComplete")))}}();
