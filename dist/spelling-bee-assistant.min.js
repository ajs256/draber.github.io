!function(){"use strict";const e=({tag:t="div",text:a="",attributes:r={},style:s={},data:n={},events:o={},classNames:i=[],cellData:l=[],cellTag:d="td"}={})=>{if("tr"===t&&l.length)return(({classNames:t=[],events:a={},cellData:r=[],cellTag:s="td"}={})=>{const n=e({tag:"tr",classNames:t,events:a});return r.forEach((t=>{n.append(e({tag:s,text:t}))})),n})({classNames:i,events:o,cellData:l,cellTag:d});if("input"===t&&"checkbox"===r.type&&a)return(({text:t="",classNames:a=[],attributes:r={},events:s={}}={})=>{const n=e({tag:"input",attributes:r,events:s}),o=e({tag:"label",text:t,classNames:a});return o.prepend(n),o})({text:a,classNames:i,attributes:r,events:o});const c=document.createElement(t);for(const[e,t]of Object.entries(s))c.style[e]=t;i.length&&c.classList.add(...i),Array.isArray(a)?c.append(e({tag:a[1],text:a[0]})):c.textContent=a;for(const[e,t]of Object.entries(r))""!==t&&c.setAttribute(e,t);for(const[e,t]of Object.entries(n))c.dataset[e]=t;for(const[e,t]of Object.entries(o))c.addEventListener(e,t,!1);return c};var t={$:(e,t=null)=>"string"==typeof e?(t||document).querySelector(e):e||null,$$:(e,t=null)=>[].slice.call((t||document).querySelectorAll(e)),create:e};let a=[];var r={add:(e,t,r)=>(e.observe(t,r),a.push(e)),remove:e=>(e.disconnect(),a=a.filter((function(t){return t!==e})),a.length),removeAll:function(){return a.forEach((e=>{this.remove(e)})),a.length}},s="sba";const n=JSON.parse(localStorage.getItem("sba-settings")||"{}"),o=Object.assign({label:"Spelling Bee Assistant",title:"Assistant",url:"https://spelling-bee-assistant.app/",prefix:s,repo:"draber/draber.github.io.git",version:"2.0.0",options:Object.assign({darkMode:{v:n.darkMode?n.darkMode.v:document.body.classList.contains("sba-dark"),t:"Dark Mode"}},n)});var i=e=>o[e]||o.options[e]||null,l=(e,t)=>{o.options[e]=t,localStorage.setItem("sba-settings",JSON.stringify(o.options))},d=()=>o,c=()=>n;const p=i("prefix"),g=(e,t="c")=>{switch(t){case"c":return(e=>e.replace(/[_-]+([a-z])/g,(e=>e[1].toUpperCase())))(p+"_"+e);case"d":return(e=>e.match(/([A-Z])/g).reduce(((e,t)=>e.replace(new RegExp(t),"-"+t.toLowerCase())),e).substring(e.slice(0,1).match(/([A-Z])/g)?1:0))(p+e.charAt(0).toUpperCase()+e.slice(1));default:return e}};let b;const m=(e,a)=>{b.foundTerms=[],b.foundPangrams=[],t.$$("li",a).forEach((e=>{const t=e.textContent;b.foundTerms.push(t),b.pangrams.includes(t)&&(b.foundPangrams.push(t),e.classList.add("sb-pangram"))})),b.remainders=b.answers.filter((e=>!b.foundTerms.includes(e))),e.dispatchEvent(new Event(g("updateComplete")))};var u=(e,t)=>{b={answers:window.gameData.today.answers,pangrams:window.gameData.today.pangrams,foundTerms:[],foundPangrams:[],remainders:[]},m(e,t),e.addEventListener(g("update"),(()=>{m(e,t)}))},f=e=>b[e],h=e=>b[e].length,v=e=>{const t=b[e];let a=0;return t.forEach((e=>{b.pangrams.includes(e)?a+=e.length+7:e.length>4?a+=e.length:a+=1})),a};let x;let k;var y=e=>(k=t.create({tag:"style",text:'\ufeff.pz-game-field{background:inherit;color:inherit}.sb-wordlist-items .sb-pangram{border-bottom:2px #f8cd05 solid}.sb-wordlist-items .sb-anagram a{color:#888}.sba-dark{background:#111;color:#eee}.sba-dark .sba{background:#111}.sba-dark .sba summary{background:#252525;color:#eee}.sba-dark .pz-nav__hamburger-inner,.sba-dark .pz-nav__hamburger-inner::before,.sba-dark .pz-nav__hamburger-inner::after{background-color:#eee}.sba-dark .pz-nav{width:100%;background:#111}.sba-dark .pz-nav__logo{filter:invert(1)}.sba-dark .sb-modal-scrim{background:rgba(17,17,17,.85);color:#eee}.sba-dark .pz-modal__title{color:#eee}.sba-dark .sb-modal-frame,.sba-dark .pz-modal__button.white{background:#111;color:#eee}.sba-dark .pz-modal__button.white:hover{background:#393939}.sba-dark .sb-message{background:#393939}.sba-dark .sb-progress-marker .sb-progress-value,.sba-dark .hive-cell.center .cell-fill{background:#f7c60a;fill:#f7c60a;color:#111}.sba-dark .sb-input-bright{color:#f7c60a}.sba-dark .hive-cell.outer .cell-fill{fill:#393939}.sba-dark .cell-fill{stroke:#111}.sba-dark .cell-letter{fill:#eee}.sba-dark .hive-cell.center .cell-letter{fill:#111}.sba-dark .hive-action:not(.hive-action__shuffle){background:#111;color:#eee}.sba-dark .hive-action__shuffle{filter:invert(100%)}.sba-dark *:not(.hive-action__shuffle):not(.sb-pangram){border-color:#333 !important}.sba{position:absolute;width:200px;background:inherit;box-sizing:border-box;z-index:3;margin:16px 0;padding:0 10px 5px;border-width:1px;border-color:#dcdcdc;border-radius:6px;border-style:solid}.sba *,.sba *:before,.sba *:after{box-sizing:border-box}.sba *:focus{outline:0}.sba .dragger{font-weight:bold;cursor:move;line-height:32px}.sba .closer,.sba .minimizer{font-size:18px;font-weight:bold;position:absolute;top:0;line-height:32px;padding:0 10px;cursor:pointer}.sba .closer{right:0}.sba .minimizer{right:16px}.sba .minimizer:before{content:"－"}.sba.minimized details{display:none}.sba.minimized .minimizer:before{content:"＋"}.sba details{font-size:90%;margin-bottom:1px}.sba details[open] summary:before{content:"－"}.sba summary{line-height:24px;padding:0 15px 0 25px;background:#f8cd05;cursor:pointer;list-style:none;position:relative}.sba summary::-webkit-details-marker{display:none}.sba summary:before{content:"＋";position:absolute;left:8px}.sba .hive-action{margin:0 auto;display:block;font-size:100%;white-space:nowrap}.sba .pane{border:1px solid #dcdcdc;border-top:none;border-collapse:collapse;width:100%;font-size:85%;margin-bottom:4px}.sba tr td:first-of-type{text-align:left}.sba tr.current{font-weight:bold;color:#f8cd05}.sba th,.sba td{border:1px solid #dcdcdc;white-space:nowrap}.sba thead th{text-align:center;padding:4px 0}.sba tbody th{text-align:right}.sba tbody td{text-align:center;padding:4px 6px}.sba [data-plugin=footer] a{color:currentColor;opacity:.6;font-size:10px;text-align:right;display:block;padding-top:8px}.sba [data-plugin=footer] a:hover{opacity:.8;text-decoration:underline}.sba .spill-title{padding:10px 6px 0px;text-align:center}.sba .spill{text-align:center;padding:17px 0;font-size:280%}.sba ul.pane{padding:5px}.sba [data-plugin=surrender] .pane{padding:10px 5px}.sba label{cursor:pointer;position:relative;line-height:19px}.sba label input{position:relative;top:2px;margin:0 10px 0 0}\n'.replace(/(\uFEFF|\\n)/gu,"")}),e.addEventListener(g("destroy"),(()=>{k.remove()})),t.$("head").append(k));const w=c(),E=(e,a,s,n,o,i=null)=>{let d=t.$(`[data-plugin="${s}"]`,e);d||(d=t.create({data:{plugin:s}}),e.append(d));const c=w[s]?w[s].v:o;o&&l(s,{v:c,t:`Display "${n}"`});const p=g(s);return e.addEventListener(p,(t=>{t.detail.enabled?E(e,a,s,n,o):z(a,s,n)})),i&&r.add(i.observer,i.target,i.args),d.append(a),a},z=(e,t,a,s=null)=>e?(e.remove(),l(t,{v:!1,t:`Display ${a}`}),s&&r.remove(s.observer),null):(console.error(`Plugin "${a}" not initialized`),null);var L={add:E,remove:z};let T;const C="Score so far",$="scoreSoFar",N=t.create({tag:"tbody"}),_=()=>{N.innerHTML="",[["Words",h("foundTerms"),h("remainders"),h("answers")],["Points",v("foundTerms"),v("remainders"),v("answers")]].forEach((e=>{N.append(t.create({tag:"tr",cellData:e}))}))};var M={add:(e,a)=>{if(!1===i($))return!1;T=t.create({tag:"details",text:[C,"summary"],attributes:{open:!0}});const r=t.create({tag:"table",classNames:["pane"]}),s=t.create({tag:"thead"});return s.append(t.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]})),r.append(s),r.append(N),_(),T.append(r),e.addEventListener(g("updateComplete"),(()=>{_()})),L.add(e,T,$,C,true)},remove:()=>L.remove(T,$,C)};let O;const D="Set-up",S="setUp",A=(e,a)=>{for(const[r,s]of Object.entries(d().options)){const n=t.create({tag:"li"});n.append(t.create({tag:"input",text:s.t,attributes:{type:"checkbox",name:r,checked:s.v},events:{click:function(){e.dispatchEvent(new CustomEvent(g(r),{detail:{enabled:this.checked}}))}}})),a.append(n)}};var j={add:(e,a)=>{O=t.create({tag:"details",text:[D,"summary"]});const r=t.create({tag:"ul",classNames:["pane"]});return O.append(r),e.addEventListener(g("launchComplete"),(()=>{A(e,r)})),L.add(e,O,S,D,false)},remove:()=>L.remove(O,S,D)};let B;const F="Spill the beans",P="spillTheBeans";let Y;var R={add:(e,a)=>{if(!1===i(P))return!1;Y=((e,t)=>({observer:new MutationObserver((t=>{e.dispatchEvent(new CustomEvent(g("spill"),{detail:{text:t.pop().target.textContent.trim()}}))})),target:t,args:{childList:!0}}))(e,t.$(".sb-hive-input-content",a));const r=t.create({classNames:["pane"]}),s=t.create({text:"Watch me while you type!",classNames:["spill-title"]}),n=t.create({text:"😐",classNames:["spill"]});return r.append(s),r.append(n),B=t.create({tag:"details",text:[F,"summary"]}),e.addEventListener("sbaSpill",(e=>{var t;n.textContent=(t=e.detail.text)?f("remainders").filter((e=>e.startsWith(t))).length?"🙂":"🙁":"😐"})),B.append(r),L.add(e,B,P,F,true,Y)},remove:()=>L.remove(B,P,F,Y)};let H;const I="Spoilers",W="spoilers",X=t.create({tag:"tbody"}),q=()=>{X.innerHTML="",(()=>{const e={},t=h("pangrams"),a=h("foundPangrams"),r=[["Pangrams",a,t-a,t]];f("answers").forEach((t=>{e[t.length]=e[t.length]||{found:0,missing:0,total:0},f("foundTerms").includes(t)?e[t.length].found++:e[t.length].missing++,e[t.length].total++}));let s=Object.keys(e);return s.sort(((e,t)=>e-t)),s.forEach((t=>{r.push([t+" "+(t>1?"letters":"letter"),e[t].found,e[t].missing,e[t].total])})),r})().forEach((e=>{X.append(t.create({tag:"tr",cellData:e}))}))};var U={add:(e,a)=>{if(!1===i(W))return!1;H=t.create({tag:"details",text:[I,"summary"]});const r=t.create({tag:"table",classNames:["pane"]}),s=t.create({tag:"thead"});return s.append(t.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]})),r.append(s),r.append(X),q(),H.append(r),e.addEventListener(g("updateComplete"),(()=>{q()})),L.add(e,H,W,I,true)},remove:()=>L.remove(H,W,I)};let J;const Z="header";let Q,G=!1;const K=(e,t)=>{[e,t].forEach((e=>{e.addEventListener("dragover",(e=>{e.preventDefault()}))})),e.addEventListener("dragstart",(e=>{if(!G)return e.preventDefault(),!1;e.target.style.opacity=".2",Q=((e,t)=>{const a=t.getBoundingClientRect(),r=e.target.getBoundingClientRect(),s=a.top+window.pageYOffset,n=J.parentElement.getBoundingClientRect(),o=a.height-(a.top-r.top)-(r.top-n.top)-n.height;return{maxL:document.documentElement.clientWidth-r.width,minT:s,maxT:s+o,offX:e.clientX-r.x,offY:e.clientY-r.y,margT:parseInt(getComputedStyle(e.target).marginTop,10)}})(e,t)}),!1),e.addEventListener("dragend",(e=>{Object.assign(e.target.style,(e=>{let t=Math.max(0,e.clientX-Q.offX);t=Math.min(t,Q.maxL)+"px";let a=Math.max(Q.minT,e.clientY+window.pageYOffset-Q.margT-Q.offY);return a=Math.min(a,Q.maxT)+"px",{left:t,top:a}})(e)),e.target.style.opacity="1"}))};var V={add:(e,a)=>{J=t.create();const r=t.create({text:i("title"),attributes:{title:"Hold the mouse down to drag"},classNames:["dragger"]});J.append(r);const s=t.create({tag:"span",text:"×",attributes:{title:"Close"},classNames:["closer"],events:{click:()=>{e.dispatchEvent(new Event(g("destroy")))}}}),n=t.create({tag:"span",attributes:{title:"Minimize"},classNames:["minimizer"],events:{click:()=>{e.classList.toggle("minimized")}}});return e.addEventListener("pointerdown",(e=>{G=!!e.target.closest('[data-plugin="header"]')})),e.addEventListener("pointerup",(e=>{G=!1})),J.append(n),J.append(s),K(e,a),L.add(e,J,Z,r,false)},remove:()=>L.remove(J,Z,"Header")};let ee;const te="Surrender",ae="surrender",re=e=>{r.removeAll(),f("remainders").forEach((a=>{e.append((e=>{const a=t.create({tag:"li",classNames:f("pangrams").includes(e)?["sb-anagram","sb-pangram"]:["sb-anagram"]});return a.append(t.create({tag:"a",text:e,attributes:{href:`https://www.google.com/search?q=${e}`,target:"_blank"}})),a})(a))}))};var se={add:(e,a)=>{if(!1===i(ae))return!1;ee=t.create({tag:"details",text:[te,"summary"]});const r=t.create({classNames:["pane"]}),s=t.create({tag:"button",classNames:["hive-action"],text:"Display answers",attributes:{type:"button"},events:{click:function(){re(t.$(".sb-wordlist-items",a))}}});return r.append(s),ee.append(r),L.add(e,ee,ae,te,true)},remove:()=>L.remove(ee,ae,te)};let ne;const oe="Steps to success",ie="stepsToSuccess";let le;const de={},ce=(e,a)=>{const s=v("answers");t.$$(".sb-modal-list li",e).forEach((e=>{const t=e.textContent.match(/([^\(]+) \((\d+)\)/);de[t[1]]=parseInt(t[2],10)})),de["Queen Bee"]=s,e.parentElement.style.opacity=0,t.$(".sb-modal-close",e).click(),r.remove(le.observer),pe(a)},pe=e=>{e.innerHTML="";const a=Object.values(de).filter((e=>e<=v("foundTerms"))).pop();for(const[r,s]of Object.entries(de))e.append(t.create({tag:"tr",classNames:s===a?["current"]:[],cellTag:"td",cellData:[r,s]}))};var ge={add:(e,a)=>{if(!1===i(ie))return!1;ne=t.create({tag:"details",text:[oe,"summary"]});const s=t.create({tag:"table",classNames:["pane"]}),n=t.create({tag:"tbody"});return s.append(n),ne.addEventListener("toggle",(()=>{if(ne.open&&!n.hasChildNodes()){const e=t.$(".sb-modal-wrapper");le=((e,a)=>({observer:new MutationObserver((r=>{const s=r.pop().target,n=t.$(".sb-modal-title",s);n&&"Rankings"===n.textContent.trim()&&(e.parentElement.style.opacity=0,ce(e,a))})),target:e,args:{childList:!0}}))(e,n),r.add(le.observer,le.target,le.args),t.$(".sb-progress",a).click()}})),ne.append(s),e.addEventListener(g("updateComplete"),(()=>{pe(n)})),L.add(e,ne,ie,oe,true)},remove:()=>L.remove(ne,ie,oe)};let be;const me="Footer",ue="footer";var fe={add:(e,a)=>(be=t.create({tag:"a",text:`${i("label")} ${i("version")}`,attributes:{href:i("url"),target:"_blank"}}),L.add(e,be,ue,me,false)),remove:()=>L.remove(be,ue,me)};const he=t.$("#pz-game-root"),ve=function(e){if(!e||!window.gameData)return console.info("This bookmarklet only works on https://www.nytimes.com/puzzles/spelling-bee"),!1;const a=t.$(".sb-content-box",e).getBoundingClientRect(),s=t.$(".sb-wordlist-items",e),n={};n[g("destroy")]=e=>{r.removeAll(),e.target.remove()},n[g("darkMode")]=e=>{e.detail.enabled?document.body.classList.add(g("dark","d")):document.body.classList.remove(g("dark","d"))};const o=t.create({attributes:{draggable:!0},style:{left:a.right+10+"px",top:a.top+window.pageYOffset+"px"},data:{id:i("repo")},classNames:[i("prefix")],events:n});return u(o,s),x=((e,t)=>({observer:new MutationObserver((t=>{e.dispatchEvent(new CustomEvent(g("update"),{detail:{text:t.pop().addedNodes[0]}}))})),target:t,args:{childList:!0}}))(o,s),r.add(x.observer,x.target,x.args),o.dispatchEvent(new CustomEvent(g("darkMode"),{detail:{enabled:i("darkMode")}})),o}(he);if(ve){const e=t.$(`[data-id="${i("repo")}"]`);e&&e.dispatchEvent(new Event(g("destroy"))),document.body.append(ve),[V,M,U,R,ge,se,j,fe].forEach((e=>{e.add(ve,he)})),y(ve),ve.dispatchEvent(new Event(g("launchComplete")))}}();
