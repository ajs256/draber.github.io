!function(){"use strict";const t=({tag:e="div",text:a="",attributes:s={},style:r={},data:n={},events:i={},classNames:o=[],cellData:l=[],cellTag:c="td",checked:p=!1}={})=>{if("tr"===e&&l.length)return(({classNames:e=[],events:a={},cellData:s=[],cellTag:r="td"}={})=>{const n=t({tag:"tr",classNames:e,events:a});return s.forEach((e=>{n.append(t({tag:r,text:e}))})),n})({classNames:o,events:i,cellData:l,cellTag:c});if("input"===e&&"checkbox"===s.type&&a)return(({text:e="",classNames:a=[],attributes:s={},events:r={},checked:n=!1}={})=>{n&&(s.checked="checked");const i=t({tag:"input",attributes:s,events:r}),o=t({tag:"label",text:e,classNames:a});return o.prepend(i),o})({text:a,classNames:o,attributes:s,events:i,checked:p});const d=document.createElement(e);for(const[t,e]of Object.entries(r))d.style[t]=e;o.length&&d.classList.add(...o),Array.isArray(a)?d.append(t({tag:a[1],text:a[0]})):d.textContent=a;for(const[t,e]of Object.entries(s))""!==e&&d.setAttribute(t,e);for(const[t,e]of Object.entries(n))d.dataset[t]=e;for(const[t,e]of Object.entries(i))d.addEventListener(t,e,!1);return d};var e={$:(t,e=null)=>"string"==typeof t?(e||document).querySelector(t):t||null,$$:(t,e=null)=>[].slice.call((e||document).querySelectorAll(t)),create:t};let a=[];var s={add:({observer:t,target:e,config:s})=>(t.observe(e,s),a.push(t)),remove:({observer:t})=>(t.disconnect(),a=a.filter((function(e){return e!==t})),a.length),removeAll:function(){return a.forEach((t=>{this.remove({observer:t})})),a.length}},r="sba";const n={label:"Spelling Bee Assistant",title:"Assistant",url:"https://spelling-bee-assistant.app/",prefix:r,repo:"draber/draber.github.io.git",version:"2.0.0",options:JSON.parse(localStorage.getItem("sba-settings")||"{}")};var i=t=>{let e=Object.create(n);for(let a of t.split(".")){if(!e[a])return;e=e[a]}return e},o=(t,e)=>{const a=t.split("."),s=a.pop();let r=n;for(let t of a){if(r[t]||(r[t]={}),"[object Object]"===!Object.prototype.toString.call(r))return console.error(`${t} is not of the type Object`),!1;r=r[t]}r[s]=e,localStorage.setItem("sba-settings",JSON.stringify(n.options))};function l(t,e="c"){switch(e){case"c":return(t=>t.replace(/[_-]+([a-z])/g,(t=>t[1].toUpperCase())))(i("prefix")+"_"+t);case"d":return(t=>t.match(/([A-Z])/g).reduce(((t,e)=>t.replace(new RegExp(e),"-"+e.toLowerCase())),t).substring(t.slice(0,1).match(/([A-Z])/g)?1:0))(i("prefix")+t.charAt(0).toUpperCase()+t.slice(1));default:return t}}let c;const p=(t,a)=>{c.foundTerms=[],c.foundPangrams=[],e.$$("li",a).forEach((t=>{const e=t.textContent;c.foundTerms.push(e),c.pangrams.includes(e)&&(c.foundPangrams.push(e),t.classList.add("sb-pangram"))})),c.remainders=c.answers.filter((t=>!c.foundTerms.includes(t))),t.dispatchEvent(new Event(l("updateComplete")))};var d=(t,e)=>{c={answers:window.gameData.today.answers,pangrams:window.gameData.today.pangrams,foundTerms:[],foundPangrams:[],remainders:[]},p(t,e),t.addEventListener(l("update"),(()=>{p(t,e)}))},b=t=>c[t],g=t=>c[t].length,h=t=>{const e=c[t];let a=0;return e.forEach((t=>{c.pangrams.includes(t)?a+=t.length+7:t.length>4?a+=t.length:a+=1})),a};const u="noUi",m=(t,e)=>{const a=i(`options.${t}.v`);return void 0!==a?a:e},f=t=>{var e,a;return t.ui instanceof HTMLElement&&t.ui.remove(),t.optional&&o(`options.${t.key}.v`,!1),t.observer&&t.observer instanceof MutationObserver&&s.remove(t.observer),e=t.cb,a="remove",e&&"function"==typeof e[a]&&e[a](),null};var v={add:t=>{const a=void 0===t.defaultState||t.defaultState,r=void 0!==t.optional&&t.optional,n=void 0===t.title?"":t.title;((t,a)=>{if(t.ui===u)return!1;const s=t.target||e.$(`[data-ui="${t.key}"]`,t.app)||(()=>{const a=e.create({data:{plugin:t.key}});return t.app.append(a),a})();m(t.key,a)&&s.append(t.ui)})(t,a),r&&o(`options.${t.key}`,{t:n,v:m(t.key,a)}),(t=>{const e=l(t.key);t.app.addEventListener(e,(e=>{e.detail.enabled?t(t.app,...t.args):f(t)}))})(t),t.observer&&t.observer instanceof MutationObserver&&s.add(t.observer)},remove:f,isEnabled:m,noUi:u};class x{constructor(t,...a){this.app=t,this.args=a,this.title="Score so far",this.key="scoreSoFar",this.optional=!0;const s=e.create({tag:"tbody"}),r=()=>{s.innerHTML="",[["Words",g("foundTerms"),g("remainders"),g("answers")],["Points",h("foundTerms"),h("remainders"),h("answers")]].forEach((t=>{s.append(e.create({tag:"tr",cellData:t}))}))};if(v.isEnabled(this.key,!0)){this.ui=e.create({tag:"details",text:[this.title,"summary"],attributes:{open:!0}});const a=e.create({tag:"table",classNames:["pane"]}),n=e.create({tag:"thead"});n.append(e.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]})),a.append(n),a.append(s),r(),this.ui.append(a),t.addEventListener(l("updateComplete"),(()=>{r()}))}}}class k{constructor(t,...a){this.app=t,this.args=a,this.title="Set-up",this.key="setUp",this.optional=!1;const s=e.create({tag:"ul",classNames:["pane"]});this.ui=e.create({tag:"details",text:[this.title,"summary"],events:{click:function(t){"INPUT"===t.target.tagName&&this.app.dispatchEvent(new CustomEvent(l(t.target.name),{detail:{enabled:t.target.checked}}))}}}),this.ui.append(s),this.app.addEventListener(l("launchComplete"),(()=>{(()=>{for(const[t,a]of Object.entries(i("options"))){const r=e.create({tag:"li"}),n=e.create({tag:"input",text:a.t,attributes:{type:"checkbox",name:t},checked:a.v});r.append(n),s.append(r)}})()}))}}class y{constructor(t,...a){this.app=t,this.args=a,this.title="Spill the beans",this.key="spillTheBeans",this.optional=!0;const s=t=>({observer:new MutationObserver((t=>{this.app.dispatchEvent(new CustomEvent(l("spill"),{detail:{text:t.pop().target.textContent.trim()}}))})),target:t,config:{childList:!0}});if(v.isEnabled(this.key,!0)){const t=e.create({classNames:["pane"]});t.append(e.create({text:"Watch me while you type!",classNames:["spill-title"]})),t.append(e.create({text:"😐",classNames:["spill"]})),this.ui=e.create({tag:"details",text:[this.title,"summary"]}),this.ui.append(t),this.observer=s(e.$(".sb-hive-input-content")),this.app.addEventListener("sbaSpill",(t=>{var e;reaction.textContent=(e=t.detail.text)?b("remainders").filter((t=>t.startsWith(e))).length?"🙂":"🙁":"😐"}))}}}class w{constructor(t,...a){this.app=t,this.args=a,this.title="Spoilers",this.key="spoilers",this.optional=!0;const s=e.create({tag:"tbody"}),r=()=>{s.innerHTML="",(()=>{const t={},e=g("pangrams"),a=g("foundPangrams"),s=[["Pangrams",a,e-a,e]];b("answers").forEach((e=>{t[e.length]=t[e.length]||{found:0,missing:0,total:0},b("foundTerms").includes(e)?t[e.length].found++:t[e.length].missing++,t[e.length].total++}));let r=Object.keys(t);return r.sort(((t,e)=>t-e)),r.forEach((e=>{s.push([e+" "+(e>1?"letters":"letter"),t[e].found,t[e].missing,t[e].total])})),s})().forEach((t=>{s.append(e.create({tag:"tr",cellData:t}))}))};if(v.isEnabled(this.key,!0)){this.ui=e.create({tag:"details",text:[this.title,"summary"]});const t=e.create({tag:"table",classNames:["pane"]}),a=e.create({tag:"thead"});a.append(e.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]})),t.append(a),t.append(s),r(),this.ui.append(t),this.app.addEventListener(l("updateComplete"),(()=>{r()}))}}}class E{constructor(t,...a){this.app=t,this.args=a,this.title=i("title"),this.key="header",this.ui=e.create();const s=this.args[0];let r,n=!1;this.ui.append(e.create({text:this.title,attributes:{title:"Hold the mouse down to drag"},classNames:["dragger"]})),this.ui.append(e.create({tag:"span",text:"×",attributes:{title:"Close"},classNames:["closer"],events:{click:()=>{this.app.dispatchEvent(new Event(l("destroy")))}}})),this.ui.append(e.create({tag:"span",attributes:{title:"Minimize"},classNames:["minimizer"],events:{click:()=>{this.app.classList.toggle("minimized")}}})),this.app.addEventListener("pointerdown",(t=>{n=!!t.target.closest(`[data-plugin="${this.key}"]`)})),this.app.addEventListener("pointerup",(()=>{n=!1})),(()=>{[this.app,s].forEach((t=>{t.addEventListener("dragover",(t=>{t.preventDefault()}))})),this.app.addEventListener("dragstart",(t=>{if(!n)return t.preventDefault(),!1;t.target.style.opacity=".2",r=(t=>{const e=s.getBoundingClientRect(),a=t.target.getBoundingClientRect(),r=e.top+window.pageYOffset,n=plugin.parentElement.getBoundingClientRect(),i=e.height-(e.top-a.top)-(a.top-n.top)-n.height;return{maxL:document.documentElement.clientWidth-a.width,minT:r,maxT:r+i,offX:t.clientX-a.x,offY:t.clientY-a.y,margT:parseInt(getComputedStyle(t.target).marginTop,10)}})(t)}),!1),this.app.addEventListener("dragend",(t=>{Object.assign(t.target.style,(t=>{let e=Math.max(0,t.clientX-r.offX);e=Math.min(e,r.maxL)+"px";let a=Math.max(r.minT,t.clientY+window.pageYOffset-r.margT-r.offY);return a=Math.min(a,r.maxT)+"px",{left:e,top:a}})(t)),t.target.style.opacity="1"}))})()}}class ${constructor(t,...a){this.app=t,this.args=a,this.title="Surrender",this.key="surrender",this.optional=!0;let r=!1;const n=t=>!r&&(s.removeAll(),b("remainders").forEach((a=>{t.append((t=>{const a=e.create({tag:"li",classNames:b("pangrams").includes(t)?["sb-anagram","sb-pangram"]:["sb-anagram"]});return a.append(e.create({tag:"a",text:t,attributes:{href:`https://www.google.com/search?q=${t}`,target:"_blank"}})),a})(a))})),r=!0,!0);if(v.isEnabled(this.key,!0)){this.ui=e.create({tag:"details",text:[this.title,"summary"]});const t=e.create({classNames:["pane"]});t.append(e.create({tag:"button",classNames:["hive-action"],text:"Display answers",attributes:{type:"button"},events:{click:function(){n(e.$(".sb-wordlist-items",a[0]))}}})),this.ui.append(t)}}}class z{constructor(t,...a){let r;this.app=t,this.args=a,this.title="Steps to success",this.key="stepsToSuccess",this.optional=!0;const n={},i=(t,a)=>{const i=h("answers");e.$$(".sb-modal-list li",t).forEach((t=>{const e=t.textContent.match(/([^\(]+) \((\d+)\)/);n[e[1]]=parseInt(e[2],10)})),n["Queen Bee"]=i,t.parentElement.style.opacity=0,e.$(".sb-modal-close",t).click(),s.remove(r),o(a)},o=t=>{t.innerHTML="";const a=Object.values(n).filter((t=>t<=h("foundTerms"))).pop();for(const[s,r]of Object.entries(n))t.append(e.create({tag:"tr",classNames:r===a?["sba-current"]:[],cellTag:"td",cellData:[s,r]}))};if(v.isEnabled(this.key,!0)){this.ui=e.create({tag:"details",text:[this.title,"summary"]});const t=e.create({tag:"table",classNames:["pane"]}),n=e.create({tag:"tbody"});t.append(n);const c=e.$(".sb-modal-buttons-section .pz-button__wrapper>button, sb-modal-close",e.$(".sb-modal-wrapper"));c&&c.click();const p=e.$(".sb-modal-wrapper");r=((t,a)=>({observer:new MutationObserver((s=>{const r=s.pop().target,n=e.$(".sb-modal-title",r);n&&"Rankings"===n.textContent.trim()&&(t.parentElement.style.opacity=0,i(t,a))})),target:t,config:{childList:!0}}))(p,n),s.add(r),e.$(".sb-progress",a[0]).click(),this.ui.append(t),this.app.addEventListener(l("updateComplete"),(()=>{o(n)}))}}}class T{constructor(t,...a){this.app=t,this.args=a,this.title=`${i("label")} ${i("version")}`,this.key="footer",this.ui=e.create({tag:"a",text:this.title,attributes:{href:i("url"),target:"_blank"}})}}class L{constructor(t,...a){this.app=t,this.args=a,this.ui=v.noUi,this.title="Dark Mode",this.key="darkMode",this.optional=!0,this.defaultState=!1,v.isEnabled(this.key,this.defaultState)?e.$("body").classList.add(l("dark","d")):e.$("body").classList.remove(l("dark","d"))}}class N{constructor(t,...a){this.app=t,this.args=a,this.title="Styles",this.key="styles",this.target=e.$("head"),this.ui=e.create({tag:"style",text:'\ufeff.pz-game-field{background:inherit;color:inherit}.sb-wordlist-items .sb-pangram{border-bottom:2px #f8cd05 solid}.sb-wordlist-items .sb-anagram a{color:#888}.sba-dark{background:#111;color:#eee}.sba-dark .sba{background:#111}.sba-dark .sba summary{background:#252525;color:#eee}.sba-dark .pz-nav__hamburger-inner,.sba-dark .pz-nav__hamburger-inner::before,.sba-dark .pz-nav__hamburger-inner::after{background-color:#eee}.sba-dark .pz-nav{width:100%;background:#111}.sba-dark .pz-nav__logo{filter:invert(1)}.sba-dark .sb-modal-scrim{background:rgba(17,17,17,.85);color:#eee}.sba-dark .pz-modal__title{color:#eee}.sba-dark .sb-modal-frame,.sba-dark .pz-modal__button.white{background:#111;color:#eee}.sba-dark .pz-modal__button.white:hover{background:#393939}.sba-dark .sb-message{background:#393939}.sba-dark .sb-progress-marker .sb-progress-value,.sba-dark .hive-cell.center .cell-fill{background:#f7c60a;fill:#f7c60a;color:#111}.sba-dark .sb-input-bright{color:#f7c60a}.sba-dark .hive-cell.outer .cell-fill{fill:#393939}.sba-dark .cell-fill{stroke:#111}.sba-dark .cell-letter{fill:#eee}.sba-dark .hive-cell.center .cell-letter{fill:#111}.sba-dark .hive-action:not(.hive-action__shuffle){background:#111;color:#eee}.sba-dark .hive-action__shuffle{filter:invert(100%)}.sba-dark *:not(.hive-action__shuffle):not(.sb-pangram):not(.sba-current){border-color:#333 !important}.sba{position:absolute;width:200px;background:inherit;box-sizing:border-box;z-index:3;margin:16px 0;padding:0 10px 5px;background:#fff;border-width:1px;border-color:#dcdcdc;border-radius:6px;border-style:solid}.sba *,.sba *:before,.sba *:after{box-sizing:border-box}.sba *:focus{outline:0}.sba .dragger{font-weight:bold;cursor:move;line-height:32px}.sba .closer,.sba .minimizer{font-size:18px;font-weight:bold;position:absolute;top:0;line-height:32px;padding:0 10px;cursor:pointer}.sba .closer{right:0}.sba .minimizer{right:16px}.sba .minimizer:before{content:"－"}.sba.minimized details{display:none}.sba.minimized .minimizer:before{content:"＋"}.sba details{font-size:90%;margin-bottom:1px}.sba details[open] summary:before{content:"－"}.sba summary{line-height:24px;padding:0 15px 0 25px;background:#f8cd05;cursor:pointer;list-style:none;position:relative}.sba summary::-webkit-details-marker{display:none}.sba summary:before{content:"＋";position:absolute;left:8px}.sba .hive-action{margin:0 auto;display:block;font-size:100%;white-space:nowrap}.sba .pane{border:1px solid #dcdcdc;border-top:none;border-collapse:collapse;width:100%;font-size:85%;margin-bottom:4px}.sba tr:first-of-type td,.sba tr:first-of-type th{border-top:none}.sba tr td:first-of-type{text-align:left}.sba tr.sba-current{font-weight:bold;border-bottom:2px solid #f8cd05 !important}.sba th,.sba td{border:1px solid #dcdcdc;white-space:nowrap}.sba thead th{text-align:center;padding:4px 0}.sba tbody th{text-align:right}.sba tbody td{text-align:center;padding:4px 6px}.sba [data-plugin=footer] a{color:currentColor;opacity:.6;font-size:10px;text-align:right;display:block;padding-top:8px}.sba [data-plugin=footer] a:hover{opacity:.8;text-decoration:underline}.sba .spill-title{padding:10px 6px 0px;text-align:center}.sba .spill{text-align:center;padding:17px 0;font-size:280%}.sba ul.pane{padding:5px}.sba [data-plugin=surrender] .pane{padding:10px 5px}.sba label{cursor:pointer;position:relative;line-height:19px}.sba label input{position:relative;top:2px;margin:0 10px 0 0}\n'.replace(/(\uFEFF|\\n)/gu,"")}),t.addEventListener(l("destroy"),(()=>{v.remove(this.key)}))}}const _=e.$("#pz-game-root"),C=function(t){if(!t||!window.gameData)return console.info("This bookmarklet only works on https://www.nytimes.com/puzzles/spelling-bee"),!1;const a=e.$(".sb-content-box",t).getBoundingClientRect(),r=e.$(".sb-wordlist-items",t),n={};n[l("destroy")]=t=>{s.removeAll(),t.target.remove()};const o=e.create({attributes:{draggable:!0},style:{left:a.right+10+"px",top:a.top+window.pageYOffset+"px"},data:{id:i("repo")},classNames:[i("prefix")],events:n});return d(o,r),s.add(((t,e)=>({observer:new MutationObserver((e=>{t.dispatchEvent(new CustomEvent(l("update"),{detail:{text:e.pop().addedNodes[0]}}))})),target:e,config:{childList:!0}}))(o,r)),o}(_);if(C){const t=e.$(`[data-id="${i("repo")}"]`);t&&t.dispatchEvent(new Event(l("destroy"))),[N,L,E,x,w,y,z,$,k,T].forEach((t=>{v.add(new t(C,_))})),e.$("body").append(C),C.dispatchEvent(new Event(l("launchComplete")))}}();
