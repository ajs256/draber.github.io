!function(){"use strict";const t=function({tag:t,text:e="",attributes:n={},style:r={},data:s={},events:a={},classNames:i=[]}={}){const o=document.createElement(t);for(const[t,r]of Object.entries({textContent:e,...n}))o[t]=r;for(const[t,e]of Object.entries(s))o.dataset[t]=e;for(const[t,e]of Object.entries(a))o.addEventListener(t,e,!1);return Object.assign(o.style,r),i.length&&o.classList.add(...i),o},e=new Proxy({$:(t,e=null)=>"string"==typeof t?(e||document).querySelector(t):t||null,$$:(t,e=null)=>[].slice.call((e||document).querySelectorAll(t))},{get:(e,n)=>function(){const r=Array.prototype.slice.call(arguments);return e.hasOwnProperty(n)&&"function"==typeof e[n]?(e[n].bind(e),e[n].apply(null,r)):t({tag:n,...r.shift()})}});var n="sba";const r={label:"Spelling Bee Assistant",title:"Assistant",url:"https://spelling-bee-assistant.app/",prefix:n,repo:"draber/draber.github.io.git",targetUrl:"https://www.nytimes.com/puzzles/spelling-bee",version:"2.0.0",options:JSON.parse(localStorage.getItem("sba-settings")||"{}")};var s=t=>{let e=Object.create(r);for(let n of t.split(".")){if(void 0===e[n])return;e=e[n]}return e},a=(t,e)=>{const n=t.split("."),s=n.pop();let a=r;for(let t of n){if(a[t]||(a[t]={}),"[object Object]"===!Object.prototype.toString.call(a))return console.error(`${t} is not of the type Object`),!1;a=a[t]}a[s]=e,localStorage.setItem("sba-settings",JSON.stringify(r.options))};const i=s("prefix"),o=t=>t.replace(/[_-]+/," ").replace(/(?:^[\w]|[A-Z]|\b\w|\s+)/g,(function(t,e){return 0==+t?"":0===e?t.toLowerCase():t.toUpperCase()})),l=(t,e="c")=>{switch(e){case"c":return o(i+"_"+t);case"d":return(t=>t.replace(/[\W_]+/g," ").split(/ |\B(?=[A-Z])/).map((t=>t.toLowerCase())).join("-"))(i+t.charAt(0).toUpperCase()+t.slice(1));default:return i+t}};let d;const p=(t,n)=>{d.foundTerms=[],d.foundPangrams=[],e.$$("li",n).forEach((t=>{if(e.$("a",t))return!1;const n=t.textContent;d.foundTerms.push(n),d.pangrams.includes(n)&&(d.foundPangrams.push(n),t.classList.add("sb-pangram"))})),d.remainders=d.answers.filter((t=>!d.foundTerms.includes(t))),t.trigger(new Event(l("wordsUpdated")))};var c=(t,e)=>{d={answers:window.gameData.today.answers,pangrams:window.gameData.today.pangrams,foundTerms:[],foundPangrams:[],remainders:[]},p(t,e),t.on(l("newWord"),(n=>{p(t,e)}))},u=t=>d[t],h=t=>d[t].length,g=t=>{const e=d[t];let n=0;return e.forEach((t=>{d.pangrams.includes(t)?n+=t.length+7:t.length>4?n+=t.length:n+=1})),n};class b{ui;title;key;hasUi=()=>this.ui instanceof HTMLElement;on=(t,e)=>{this.ui.addEventListener(t,e)};trigger=t=>{this.ui.dispatchEvent(t)};constructor(t,{key:e}={}){if(!t)throw new TypeError(`${Object.getPrototypeOf(this.constructor).name} expects at exactly 1 arguments, ${arguments.length} passed from ${this.constructor.name}`);this.title=t,this.key=e||o(t)}}class m extends b{defaultEnabled=!0;optional=!1;target;app;isEnabled=()=>{const t=s(`options.${this.key}`);return void 0!==t?t:this.defaultEnabled};toggle=t=>{a(`options.${this.key}`,t),this.ui.classList.toggle("inactive",!t)};attach=()=>{if(!this.hasUi())return!1;return(this.target||e.$(`[data-ui="${this.key}"]`,this.app.ui)||(()=>{const t=e.div({data:{plugin:this.key}});return this.app.ui.append(t),t})()).append(this.ui),!0};add=()=>{this.attach(),this.optional&&a(`options.${this.key}`,this.isEnabled())};constructor(t,e,{key:n,optional:r,defaultEnabled:s}={}){if(!t||!e)throw new TypeError(`${Object.getPrototypeOf(this.constructor).name} expects at least 2 arguments, 'app' or 'title' missing from ${this.constructor.name}`);super(e,{key:n}),this.app=t,this.optional=void 0!==r?r:this.optional,this.defaultEnabled=void 0!==s?s:this.defaultEnabled}}const f=t=>{t.innerHTML="",[["Words",h("foundTerms"),h("remainders"),h("answers")],["Points",g("foundTerms"),g("remainders"),g("answers")]].forEach((n=>{const r=e.tr();n.forEach((t=>{r.append(e.td({text:t}))})),t.append(r)}))};var x={styles:class extends m{constructor(t){super(t,"Styles"),this.target=e.$("head"),this.ui=e.style({text:'@charset "UTF-8";\r\n.pz-game-field {\r\n  background: inherit;\r\n  color: inherit; }\r\n\r\n.sb-wordlist-items .sb-pangram {\r\n  border-bottom: 2px #f8cd05 solid; }\r\n.sb-wordlist-items .sb-anagram a {\r\n  color: #888; }\r\n\r\n.sba-dark {\r\n  background: #111;\r\n  color: #eee; }\r\n  .sba-dark .sba {\r\n    background: #111; }\r\n    .sba-dark .sba summary {\r\n      background: #252525;\r\n      color: #eee; }\r\n  .sba-dark .pz-nav__hamburger-inner,\r\n  .sba-dark .pz-nav__hamburger-inner::before,\r\n  .sba-dark .pz-nav__hamburger-inner::after {\r\n    background-color: #eee; }\r\n  .sba-dark .pz-nav {\r\n    width: 100%;\r\n    background: #111; }\r\n  .sba-dark .pz-nav__logo {\r\n    filter: invert(1); }\r\n  .sba-dark .sb-modal-scrim {\r\n    background: rgba(17, 17, 17, 0.85);\r\n    color: #eee; }\r\n  .sba-dark .pz-modal__title {\r\n    color: #eee; }\r\n  .sba-dark .sb-modal-frame,\r\n  .sba-dark .pz-modal__button.white {\r\n    background: #111;\r\n    color: #eee; }\r\n  .sba-dark .pz-modal__button.white:hover {\r\n    background: #393939; }\r\n  .sba-dark .sb-message {\r\n    background: #393939; }\r\n  .sba-dark .sb-progress-marker .sb-progress-value,\r\n  .sba-dark .hive-cell.center .cell-fill {\r\n    background: #f7c60a;\r\n    fill: #f7c60a;\r\n    color: #111; }\r\n  .sba-dark .sb-input-bright {\r\n    color: #f7c60a; }\r\n  .sba-dark .hive-cell.outer .cell-fill {\r\n    fill: #393939; }\r\n  .sba-dark .cell-fill {\r\n    stroke: #111; }\r\n  .sba-dark .cell-letter {\r\n    fill: #eee; }\r\n  .sba-dark .hive-cell.center .cell-letter {\r\n    fill: #111; }\r\n  .sba-dark .hive-action:not(.hive-action__shuffle) {\r\n    background: #111;\r\n    color: #eee; }\r\n  .sba-dark .hive-action__shuffle {\r\n    filter: invert(100%); }\r\n  .sba-dark *:not(.hive-action__shuffle):not(.sb-pangram):not(.sba-current) {\r\n    border-color: #333 !important; }\r\n\r\n.sba {\r\n  position: absolute;\r\n  width: 200px;\r\n  background: inherit;\r\n  box-sizing: border-box;\r\n  z-index: 3;\r\n  margin: 16px 0;\r\n  padding: 0 10px 5px;\r\n  background: #fff;\r\n  border-width: 1px;\r\n  border-color: gainsboro;\r\n  border-radius: 6px;\r\n  border-style: solid; }\r\n  .sba *,\r\n  .sba *:before,\r\n  .sba *:after {\r\n    box-sizing: border-box; }\r\n  .sba *:focus {\r\n    outline: 0; }\r\n  .sba .dragger {\r\n    font-weight: bold;\r\n    cursor: move;\r\n    line-height: 32px; }\r\n  .sba .closer,\r\n  .sba .minimizer {\r\n    font-size: 18px;\r\n    font-weight: bold;\r\n    position: absolute;\r\n    top: 0;\r\n    line-height: 32px;\r\n    padding: 0 10px;\r\n    cursor: pointer; }\r\n  .sba .closer {\r\n    right: 0; }\r\n  .sba .minimizer {\r\n    right: 16px;\r\n    transform: rotate(-90deg);\r\n    transform-origin: center;\r\n    font-size: 10px;\r\n    right: 24px;\r\n    top: 1px; }\r\n    .sba .minimizer:before {\r\n      content: "❯"; }\r\n  .sba.minimized details {\r\n    display: none; }\r\n  .sba.minimized .minimizer {\r\n    transform: rotate(90deg);\r\n    right: 25px;\r\n    top: 0; }\r\n  .sba details {\r\n    font-size: 90%;\r\n    margin-bottom: 1px;\r\n    max-height: 800px;\r\n    transition: max-height 0.25s ease-in; }\r\n    .sba details[open] summary:before {\r\n      transform: rotate(-90deg);\r\n      left: 12px;\r\n      top: 0; }\r\n    .sba details.inactive {\r\n      height: 0;\r\n      max-height: 0;\r\n      transition: max-height 0.25s ease-out;\r\n      overflow: hidden;\r\n      margin: 0; }\r\n  .sba summary {\r\n    line-height: 24px;\r\n    padding: 0 15px 0 25px;\r\n    background: #f8cd05;\r\n    cursor: pointer;\r\n    list-style: none;\r\n    position: relative; }\r\n    .sba summary::-webkit-details-marker {\r\n      display: none; }\r\n    .sba summary:before {\r\n      content: "❯";\r\n      font-size: 9px;\r\n      position: absolute;\r\n      display: inline-block;\r\n      transform: rotate(90deg);\r\n      transform-origin: center;\r\n      left: 9px;\r\n      top: -1px; }\r\n  .sba .hive-action {\r\n    margin: 0 auto;\r\n    display: block;\r\n    font-size: 100%;\r\n    white-space: nowrap; }\r\n  .sba .pane {\r\n    border: 1px solid gainsboro;\r\n    border-top: none;\r\n    border-collapse: collapse;\r\n    width: 100%;\r\n    font-size: 85%;\r\n    margin-bottom: 4px; }\r\n  .sba tr:first-of-type td,\r\n  .sba tr:first-of-type th {\r\n    border-top: none; }\r\n  .sba tr td:first-of-type {\r\n    text-align: left; }\r\n  .sba tr.sba-current {\r\n    font-weight: bold;\r\n    border-bottom: 2px solid #f8cd05 !important; }\r\n  .sba th,\r\n  .sba td {\r\n    border: 1px solid gainsboro;\r\n    white-space: nowrap; }\r\n  .sba thead th {\r\n    text-align: center;\r\n    padding: 4px 0; }\r\n  .sba tbody th {\r\n    text-align: right; }\r\n  .sba tbody td {\r\n    text-align: center;\r\n    padding: 4px 6px; }\r\n  .sba [data-plugin="footer"] a {\r\n    color: currentColor;\r\n    opacity: .6;\r\n    font-size: 10px;\r\n    text-align: right;\r\n    display: block;\r\n    padding-top: 8px; }\r\n    .sba [data-plugin="footer"] a:hover {\r\n      opacity: .8;\r\n      text-decoration: underline; }\r\n  .sba .spill-title {\r\n    padding: 10px 6px 0px;\r\n    text-align: center; }\r\n  .sba .spill {\r\n    text-align: center;\r\n    padding: 17px 0;\r\n    font-size: 280%; }\r\n  .sba ul.pane {\r\n    padding: 5px; }\r\n  .sba [data-plugin="surrender"] .pane {\r\n    padding: 10px 5px; }\r\n  .sba label {\r\n    cursor: pointer;\r\n    position: relative;\r\n    line-height: 19px; }\r\n    .sba label input {\r\n      position: relative;\r\n      top: 2px;\r\n      margin: 0 10px 0 0; }\r\n'.replace(/(\uFEFF|\\n)/gu,"")}),t.on(l("destroy"),(()=>{this.ui.remove()})),this.add()}},darkMode:class extends m{constructor(t){super(t,"Dark Mode",{optional:!0,defaultEnabled:!1});const n=l("dark","d");this.toggle=t=>{a(`options.${this.key}`,t),e.$("body").classList.toggle(n,t)},this.toggle(this.isEnabled()),this.add()}},header:class extends m{constructor(t){let n;super(t,s("title"),{key:"header"}),this.ui=e.div();let r=!1;const a=e=>{const n=t.game.getBoundingClientRect(),r=e.target.getBoundingClientRect(),s=n.top+window.pageYOffset,a=this.ui.parentElement.getBoundingClientRect(),i=n.height-(n.top-r.top)-(r.top-a.top)-a.height;return{maxL:document.documentElement.clientWidth-r.width,minT:s,maxT:s+i,offX:e.screenX-r.x,offY:e.screenY-r.y,margT:parseInt(getComputedStyle(e.target).marginTop,10)}};this.ui.append(e.div({text:this.title,attributes:{title:"Hold the mouse down to drag"},classNames:["dragger"]})),this.ui.append(e.span({text:"×",attributes:{title:"Close"},classNames:["closer"],events:{click:()=>{t.trigger(new Event(l("destroy")))}}})),this.ui.append(e.span({attributes:{title:"Minimize"},classNames:["minimizer"],events:{click:()=>{t.ui.classList.toggle("minimized")}}})),t.on("pointerdown",(t=>{r=!!t.target.closest(`[data-plugin="${this.key}"]`)})),t.on("pointerup",(()=>{r=!1})),[t.ui,t.game].forEach((t=>{t.addEventListener("dragover",(t=>{t.preventDefault()}))})),t.on("dragstart",(t=>{if(!r)return t.preventDefault(),!1;t.target.style.opacity=".2",n=a(t)}),!1),t.on("dragend",(t=>{Object.assign(t.target.style,(t=>{let e=Math.max(0,t.screenX-n.offX);e=Math.min(e,n.maxL)+"px";let r=Math.max(n.minT,t.screenY+window.pageYOffset-n.margT-n.offY);return r=Math.min(r,n.maxT)+"px",{left:e,top:r}})(t)),t.target.style.opacity="1"})),this.add()}},scoreSoFar:class extends m{constructor(t){super(t,"Score so far",{optional:!0}),this.ui=e.details({attributes:{open:!0},classNames:this.isEnabled()?[]:["inactive"]}),this.ui.append(e.summary({text:this.title}));const n=e.table({classNames:["pane"]}),r=e.thead(),s=e.tr();["","Found","Missing","Total"].forEach((t=>{s.append(e.th({text:t}))})),r.append(s);const a=e.tbody();n.append(r),n.append(a),f(a),this.ui.append(n),t.on(l("wordsUpdated"),(t=>{f(a)})),this.add()}},spoilers:class extends m{constructor(t){super(t,"Spoilers",{optional:!0});const n=e.tbody(),r=()=>{n.innerHTML="",(()=>{const t={},e=h("pangrams"),n=h("foundPangrams"),r=[["Pangrams",n,e-n,e]];u("answers").forEach((e=>{t[e.length]=t[e.length]||{found:0,missing:0,total:0},u("foundTerms").includes(e)?t[e.length].found++:t[e.length].missing++,t[e.length].total++}));let s=Object.keys(t);return s.sort(((t,e)=>t-e)),s.forEach((e=>{r.push([e+" "+(e>1?"letters":"letter"),t[e].found,t[e].missing,t[e].total])})),r})().forEach((t=>{const r=e.tr();t.forEach((t=>{r.append(e.td({text:t}))})),n.append(r)}))};this.ui=e.details({classNames:this.isEnabled()?[]:["inactive"]}),this.ui.append(e.summary({text:this.title}));const s=e.table({classNames:["pane"]}),a=e.thead(),i=e.tr();["","Found","Missing","Total"].forEach((t=>{i.append(e.th({text:t}))})),a.append(i),s.append(a),s.append(n),r(),this.ui.append(s),t.on(l("wordsUpdated"),(()=>{r()})),this.add()}},spillTheBeans:class extends m{constructor(t){super(t,"Spill the beans",{optional:!0});this.ui=e.details({classNames:this.isEnabled()?[]:["inactive"]}),this.ui.append(e.summary({text:this.title}));const n=e.div({classNames:["pane"]});n.append(e.div({text:"Watch me while you type!",classNames:["spill-title"]}));const r=e.div({text:"😐",classNames:["spill"]});n.append(r),this.ui.append(n),new MutationObserver((t=>{var e;r.textContent=(e=t.pop().target.textContent.trim())?u("remainders").filter((t=>t.startsWith(e))).length?"🙂":"🙁":"😐"})).observe(e.$(".sb-hive-input-content",t.game),{childList:!0}),this.add()}},stepsToSuccess:class extends m{constructor(t){super(t,"Steps to success",{optional:!0});const n=g("answers"),r=[["Beginner",0],["Good Start",2],["Moving Up",5],["Good",8],["Solid",15],["Nice",25],["Great",40],["Amazing",50],["Genius",70],["Queen Bee",100]].map((t=>[t[0],Math.round(t[1]/100*n)])),s=t=>{t.innerHTML="";const n=g("foundTerms"),s=r.filter((t=>t[1]<=n)).pop()[1];r.forEach((n=>{const r=e.tr({classNames:n[1]===s?["sba-current"]:[]});[n[0],n[1]].forEach((t=>{r.append(e.td({text:t}))})),t.append(r)}))};this.ui=e.details({classNames:this.isEnabled()?[]:["inactive"]}),this.ui.append(e.summary({text:this.title}));const a=e.table({classNames:["pane"]}),i=e.tbody();s(i),a.append(i),this.ui.append(a),t.on(l("wordsUpdated"),(()=>{s(i)})),this.add()}},surrender:class extends m{constructor(t){super(t,"Surrender",{optional:!0});let n=!1;const r=r=>!n&&(t.observer.disconnect(),u("remainders").forEach((t=>{r.append((t=>{const n=e.li({classNames:u("pangrams").includes(t)?["sb-anagram","sb-pangram"]:["sb-anagram"]});return n.append(e.a({text:t,attributes:{href:`https://www.google.com/search?q=${t}`,target:"_blank"}})),n})(t))})),n=!0,!0);this.ui=e.details({classNames:this.isEnabled()?[]:["inactive"]}),this.ui.append(e.summary({text:this.title}));const s=e.div({classNames:["pane"]});s.append(e.button({tag:"button",classNames:["hive-action"],text:"Display answers",attributes:{type:"button"},events:{click:()=>{r(e.$(".sb-wordlist-items",t.game))}}})),this.ui.append(s),this.add()}},setUp:class extends m{constructor(t){super(t,"Set-up");const n=e.ul({classNames:["pane"]});this.ui=e.details({events:{click:function(e){"INPUT"===e.target.tagName&&t.registry.get(e.target.name).toggle(e.target.checked)}}}),this.ui.append(e.summary({text:this.title})),this.ui.append(n),(n=>{t.registry.forEach(((t,r)=>{if(!t.optional)return!1;const s=e.li(),a=e.label({text:t.title}),i=e.input({attributes:{type:"checkbox",name:r,checked:t.isEnabled()}});a.prepend(i),s.append(a),n.append(s)}))})(n),this.add()}},footer:class extends m{constructor(t){super(t,`${s("label")} ${s("version")}`,{key:"footer"}),this.ui=e.a({text:this.title,attributes:{href:s("url"),target:"_blank"}}),this.add()}}};new class extends b{constructor(t){if(!t||!window.gameData)return console.info(`This bookmarklet only works on ${s("targetUrl")}`),!1;super(s("label")),this.game=t;const n=e.$(`[data-id="${this.key}"]`);n&&n.dispatchEvent(new Event(l("destroy"))),this.registry=new Map;const r=e.$(".sb-content-box",t).getBoundingClientRect(),a=e.$(".sb-wordlist-items",t),i={};i[l("destroy")]=()=>{this.observer.disconnect(),this.ui.remove()},this.ui=e.div({attributes:{draggable:!0},style:{left:r.right+10+"px",top:r.top+window.pageYOffset+"px"},data:{id:this.key},classNames:[s("prefix")],events:i}),c(this,a),this.observer=new MutationObserver((()=>{this.trigger(new Event(l("newWord")))})),this.observer.observe(a,{childList:!0}),this.registerPlugins=t=>{for(const[e,n]of Object.entries(t))this.registry.set(e,new n(this))},e.$("body").append(this.ui)}}(e.$("#pz-game-root")).registerPlugins(x)}();
