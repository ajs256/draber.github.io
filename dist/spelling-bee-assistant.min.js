!function(){"use strict";const t=function({tag:t,text:e="",attributes:s={},style:a={},data:i={},events:r={},classNames:n=[]}={}){const o=document.createElement(t);for(const[t,a]of Object.entries({textContent:e,...s}))o[t]=a;for(const[t,e]of Object.entries(i))o.dataset[t]=e;for(const[t,e]of Object.entries(r))o.addEventListener(t,e,!1);return Object.assign(o.style,a),n.length&&o.classList.add(...n),o},e=new Proxy({$:(t,e=null)=>"string"==typeof t?(e||document).querySelector(t):t||null,$$:(t,e=null)=>[].slice.call((e||document).querySelectorAll(t))},{get:(e,s)=>function(){const a=Array.prototype.slice.call(arguments);return e.hasOwnProperty(s)&&"function"==typeof e[s]?(e[s].bind(e),e[s].apply(null,a)):t({tag:s,...a.shift()})}});var s="sba";const a={label:"Spelling Bee Assistant",title:"Assistant",url:"https://spelling-bee-assistant.app/",prefix:s,repo:"draber/draber.github.io.git",targetUrl:"https://www.nytimes.com/puzzles/spelling-bee",version:"2.0.0",options:JSON.parse(localStorage.getItem("sba-settings")||"{}")};var i=t=>{let e=Object.create(a);for(let s of t.split(".")){if(void 0===e[s])return;e=e[s]}return e},r=(t,e)=>{const s=t.split("."),i=s.pop();let r=a;for(let t of s){if(r[t]||(r[t]={}),"[object Object]"===!Object.prototype.toString.call(r))return console.error(`${t} is not of the type Object`),!1;r=r[t]}r[i]=e,localStorage.setItem("sba-settings",JSON.stringify(a.options))};const n=i("prefix"),o=t=>t.replace(/[_-]+/," ").replace(/(?:^[\w]|[A-Z]|\b\w|\s+)/g,(function(t,e){return 0==+t?"":0===e?t.toLowerCase():t.toUpperCase()})),l=(t,e="c")=>{switch(e){case"c":return o(n+"_"+t);case"d":return(t=>t.replace(/[\W_]+/g," ").split(/ |\B(?=[A-Z])/).map((t=>t.toLowerCase())).join("-"))(n+t.charAt(0).toUpperCase()+t.slice(1));default:return n+t}};let c;const d=(t,s)=>{c.foundTerms=[],c.foundPangrams=[],e.$$("li",s).forEach((t=>{if(e.$("a",t))return!1;const s=t.textContent;c.foundTerms.push(s),c.pangrams.includes(s)&&(c.foundPangrams.push(s),t.classList.add("sb-pangram"))})),c.remainders=c.answers.filter((t=>!c.foundTerms.includes(t))),t.trigger(new Event(l("wordsUpdated")))};var p=(t,e)=>{c={answers:window.gameData.today.answers,pangrams:window.gameData.today.pangrams,foundTerms:[],foundPangrams:[],remainders:[]},d(t,e),t.on(l("newWord"),(s=>d(t,e)))},u=t=>c[t],g=t=>c[t].length,h=t=>{const e=c[t];let s=0;return e.forEach((t=>{c.pangrams.includes(t)?s+=t.length+7:t.length>4?s+=t.length:s+=1})),s};class b{defaultActive=!0;ui;title;key;canDeactivate=!1;isActive=()=>{const t=i(`options.${this.key}`);return void 0!==t?t:this.defaultActive};toggle=t=>this.canDeactivate?(r(`options.${this.key}`,t),this.ui.classList.toggle("inactive",!t),this):this;hasUi=()=>this.ui instanceof HTMLElement;on=(t,e)=>(this.ui.addEventListener(t,e),this);trigger=t=>(this.ui.dispatchEvent(t),this);constructor(t,{key:e,canDeactivate:s,defaultActive:a}={}){if(!t)throw new TypeError(`Missing 'title' from ${this.constructor.name}`);this.title=t,this.key=e||o(t),this.canDeactivate=void 0!==s?s:this.canDeactivate,this.defaultActive=void 0!==a?a:this.defaultActive}}class m extends b{target;app;attach=()=>this.hasUi()?(this.ui.dataset.ui=this.key,this.toggle(this.isActive()),(this.target||this.app.ui).append(this.ui),this):this;add=()=>(this.canDeactivate&&r(`options.${this.key}`,this.isActive()),this.attach());constructor(t,e,{key:s,canDeactivate:a,defaultActive:i}={}){if(!t||!e)throw new TypeError(`${Object.getPrototypeOf(this.constructor).name} expects at least 2 arguments, 'app' or 'title' missing from ${this.constructor.name}`);super(e,{key:s,canDeactivate:a,defaultActive:i}),this.app=t}}let f,x=!1;const v=(t,e,s)=>{if(!t.ui.draggable)return!1;s.ui.style.cursor="move",t.on("pointerdown",(t=>{x=!!t.target.closest(`[data-ui="${s.key}`)})).on("pointerup",(()=>{x=!1})).on("dragend",(e=>{Object.assign(t.ui.style,(t=>{let e=Math.max(0,t.screenX-f.offX);e=Math.min(e,f.maxL)+"px";let s=Math.max(f.minT,t.screenY+window.pageYOffset-f.margT-f.offY);return s=Math.min(s,f.maxT)+"px",{left:e,top:s}})(e)),e.target.style.opacity="1"})).on("dragstart",(a=>{if(!x)return a.preventDefault(),!1;t.ui.style.opacity=".2",f=((t,e,s,a)=>{const i=s.getBoundingClientRect(),r=e.ui.getBoundingClientRect(),n=i.top+window.pageYOffset,o=a.ui.parentElement.getBoundingClientRect(),l=i.height-(i.top-r.top)-(r.top-o.top)-o.height;return{maxL:document.documentElement.clientWidth-r.width,minT:n,maxT:n+l,offX:t.screenX-r.x,offY:t.screenY-r.y,margT:parseInt(getComputedStyle(e.ui).marginTop,10)}})(a,t,e,s)}),!1).on("dragover",(t=>t.preventDefault())),e.addEventListener("dragover",(t=>t.preventDefault()))};const y=t=>{t.innerHTML="",[["","Found","Missing","Total"],["Words",g("foundTerms"),g("remainders"),g("answers")],["Points",h("foundTerms"),h("remainders"),h("answers")]].forEach((s=>{const a=e.tr();s.forEach((t=>{a.append(e.td({text:t}))})),t.append(a)}))};var k={Styles:class extends m{constructor(t){super(t,"Styles"),this.target=e.$("head"),this.ui=e.style({text:'\ufeff.pz-game-field{background:inherit;color:inherit}.sb-wordlist-items .sb-pangram{border-bottom:2px #f8cd05 solid}.sb-wordlist-items .sb-anagram a{color:#888}.sba-dark{background:#111;color:#eee}.sba-dark .sba{background:#111}.sba-dark .sba summary{background:#252525;color:#eee}.sba-dark .pz-nav__hamburger-inner,.sba-dark .pz-nav__hamburger-inner::before,.sba-dark .pz-nav__hamburger-inner::after{background-color:#eee}.sba-dark .pz-nav{width:100%;background:#111}.sba-dark .pz-nav__logo{filter:invert(1)}.sba-dark .sb-modal-scrim{background:rgba(17,17,17,.85);color:#eee}.sba-dark .pz-modal__title{color:#eee}.sba-dark .sb-modal-frame,.sba-dark .pz-modal__button.white{background:#111;color:#eee}.sba-dark .pz-modal__button.white:hover{background:#393939}.sba-dark .sb-message{background:#393939}.sba-dark .sb-input-invalid{color:#666}.sba-dark .sb-progress-marker .sb-progress-value,.sba-dark .hive-cell.center .cell-fill{background:#f7c60a;fill:#f7c60a;color:#111}.sba-dark .sb-input-bright{color:#f7c60a}.sba-dark .hive-cell.outer .cell-fill{fill:#393939}.sba-dark .cell-fill{stroke:#111}.sba-dark .cell-letter{fill:#eee}.sba-dark .hive-cell.center .cell-letter{fill:#111}.sba-dark .hive-action:not(.hive-action__shuffle){background:#111;color:#eee}.sba-dark .hive-action__shuffle{filter:invert(100%)}.sba-dark *:not(.hive-action__shuffle):not(.sb-pangram):not(.sba-current){border-color:#333 !important}.sba{position:absolute;width:200px;background:inherit;box-sizing:border-box;z-index:3;margin:16px 0;padding:0 10px 5px;background:#fff;border-width:1px;border-color:#dcdcdc;border-radius:6px;border-style:solid}.sba *,.sba *:before,.sba *:after{box-sizing:border-box}.sba *:focus{outline:0}.sba .dragger{font-weight:bold;line-height:32px}.sba .closer,.sba .minimizer{font-size:18px;font-weight:bold;position:absolute;top:0;line-height:32px;padding:0 10px;cursor:pointer}.sba .closer{right:0}.sba .minimizer{right:16px;transform:rotate(-90deg);transform-origin:center;font-size:10px;right:24px;top:1px}.sba .minimizer:before{content:"❯"}.sba.inactive details{display:none}.sba.inactive .minimizer{transform:rotate(90deg);right:25px;top:0}.sba details{font-size:90%;margin-bottom:1px;max-height:800px;transition:max-height .25s ease-in}.sba details[open] summary:before{transform:rotate(-90deg);left:12px;top:0}.sba details.inactive{height:0;max-height:0;transition:max-height .25s ease-out;overflow:hidden;margin:0}.sba summary{line-height:24px;padding:0 15px 0 25px;background:#f8cd05;cursor:pointer;list-style:none;position:relative}.sba summary::-webkit-details-marker{display:none}.sba summary:before{content:"❯";font-size:9px;position:absolute;display:inline-block;transform:rotate(90deg);transform-origin:center;left:9px;top:-1px}.sba .pane{border:1px solid #dcdcdc;border-top:none;border-collapse:collapse;width:100%;font-size:85%;margin-bottom:4px}.sba tr:first-of-type td{border-top:none}.sba tr.sba-current{font-weight:bold;border-bottom:2px solid #f8cd05 !important}.sba td{border:1px solid #dcdcdc;white-space:nowrap;text-align:center;padding:4px 3px}.sba td:first-of-type{text-align:left}.sba [data-ui=footer]{color:currentColor;opacity:.6;font-size:10px;text-align:right;display:block;padding-top:8px}.sba [data-ui=footer]:hover{opacity:.8;text-decoration:underline}.sba .spill-title{padding:10px 6px 0px;text-align:center}.sba .spill{text-align:center;padding:17px 0;font-size:280%}.sba ul.pane{padding:5px}.sba [data-ui=surrender] .pane{padding:10px 5px}.sba [data-ui=surrender] button{margin:0 auto;display:block;font-size:100%;white-space:nowrap;padding:12px 20px}.sba label{cursor:pointer;position:relative;line-height:19px}.sba label input{position:relative;top:2px;margin:0 10px 0 0}\n'.replace(/(\uFEFF|\\n)/gu,"")}),t.on(l("destroy"),(()=>this.ui.remove())),this.add()}},DarkMode:class extends m{constructor(t){super(t,"Dark Mode",{canDeactivate:!0,defaultActive:!1}),this.toggle=t=>(r(`options.${this.key}`,t),e.$("body").classList.toggle(l("dark","d"),t),this),this.toggle(this.isActive()),this.add()}},Header:class extends m{constructor(t){super(t,i("title"),{key:"header"}),this.ui=e.div(),this.ui.append(e.div({text:this.title,attributes:{title:"Hold the mouse down to drag"},classNames:["dragger"]}),e.span({attributes:{title:"Minimize"},classNames:["minimizer"],events:{click:()=>{console.log("toggle app"),t.toggle(!t.isActive())}}}),e.span({text:"×",attributes:{title:"Close"},classNames:["closer"],events:{click:()=>t.trigger(new Event(l("destroy")))}})),v(t,t.game,this),this.add()}},ScoreSoFar:class extends m{constructor(t){super(t,"Score so far",{canDeactivate:!0}),this.ui=e.details({attributes:{open:!0}});const s=e.table({classNames:["pane"]}),a=e.tbody();s.append(a),y(a),this.ui.append(e.summary({text:this.title}),s),t.on(l("wordsUpdated"),(()=>y(a))),this.add()}},Spoilers:class extends m{constructor(t){super(t,"Spoilers",{canDeactivate:!0});const s=e.tbody(),a=()=>{s.innerHTML="",(()=>{const t={},e=g("pangrams"),s=g("foundPangrams"),a=[["","Found","Missing","Total"],["Pangrams",s,e-s,e]];u("answers").forEach((e=>{t[e.length]=t[e.length]||{found:0,missing:0,total:0},u("foundTerms").includes(e)?t[e.length].found++:t[e.length].missing++,t[e.length].total++}));let i=Object.keys(t);return i.sort(((t,e)=>t-e)),i.forEach((e=>{a.push([e+" "+(e>1?"letters":"letter"),t[e].found,t[e].missing,t[e].total])})),a})().forEach((t=>{const a=e.tr();t.forEach((t=>{a.append(e.td({text:t}))})),s.append(a)}))};this.ui=e.details();const i=e.table({classNames:["pane"]});i.append(s),a(),this.ui.append(e.summary({text:this.title}),i),t.on(l("wordsUpdated"),(()=>a())),this.add()}},SpillTheBeans:class extends m{constructor(t){super(t,"Spill the beans",{canDeactivate:!0});this.ui=e.details();const s=e.div({classNames:["pane"]});s.append(e.div({text:"Watch me while you type!",classNames:["spill-title"]}));const a=e.div({text:"😐",classNames:["spill"]});s.append(a),this.ui.append(e.summary({text:this.title}),s),new MutationObserver((t=>{var e;a.textContent=(e=t.pop().target.textContent.trim())?u("remainders").filter((t=>t.startsWith(e))).length?"🙂":"🙁":"😐"})).observe(e.$(".sb-hive-input-content",t.game),{childList:!0}),this.add()}},StepsToSuccess:class extends m{constructor(t){super(t,"Steps to success",{canDeactivate:!0});const s=h("answers"),a=[["Beginner",0],["Good Start",2],["Moving Up",5],["Good",8],["Solid",15],["Nice",25],["Great",40],["Amazing",50],["Genius",70],["Queen Bee",100]].map((t=>[t[0],Math.round(t[1]/100*s)])),i=t=>{t.innerHTML="";const s=h("foundTerms"),i=a.filter((t=>t[1]<=s)).pop()[1];a.forEach((s=>{const a=e.tr({classNames:s[1]===i?["sba-current"]:[]});[s[0],s[1]].forEach((t=>{a.append(e.td({text:t}))})),t.append(a)}))};this.ui=e.details();const r=e.table({classNames:["pane"]}),n=e.tbody();i(n),r.append(n),this.ui.append(e.summary({text:this.title}),r),t.on(l("wordsUpdated"),(()=>i(n))),this.add()}},Surrender:class extends m{constructor(t){super(t,"Surrender",{canDeactivate:!0});let s=!1;const a=a=>!s&&(t.observer.disconnect(),u("remainders").forEach((t=>a.append((t=>{const s=e.li({classNames:u("pangrams").includes(t)?["sb-anagram","sb-pangram"]:["sb-anagram"]});return s.append(e.a({text:t,attributes:{href:`https://www.google.com/search?q=${t}`,target:"_blank"}})),s})(t)))),s=!0,!0);this.ui=e.details();const i=e.div({classNames:["pane"]});i.append(e.button({tag:"button",classNames:["hive-action"],text:"Display answers",attributes:{type:"button"},events:{click:()=>a(e.$(".sb-wordlist-items",t.game))}})),this.ui.append(e.summary({text:this.title}),i),this.add()}},SetUp:class extends m{constructor(t){super(t,"Set-up");const s=e.ul({classNames:["pane"]});this.ui=e.details({events:{click:e=>{"INPUT"===e.target.tagName&&t.registry.get(e.target.name).toggle(e.target.checked)}}}),this.ui.append(e.summary({text:this.title}),s),(s=>{t.registry.forEach(((t,a)=>{if(!t.canDeactivate)return!1;const i=e.li(),r=e.label({text:t.title}),n=e.input({attributes:{type:"checkbox",name:a,checked:t.isActive()}});r.prepend(n),i.append(r),s.append(i)}))})(s),this.add()}},Footer:class extends m{constructor(t){super(t,`${i("label")} ${i("version")}`,{key:"footer"}),this.ui=e.a({text:this.title,attributes:{href:i("url"),target:"_blank"}}),this.add()}}};new class extends b{constructor(t){if(!t||!window.gameData)return console.info(`This bookmarklet only works on ${i("targetUrl")}`),!1;super(i("label"),{canDeactivate:!0}),this.game=t;const s=e.$(`[data-id="${this.key}"]`);s&&s.dispatchEvent(new Event(l("destroy"))),this.registry=new Map;const a=e.$(".sb-content-box",t).getBoundingClientRect(),r=e.$(".sb-wordlist-items",t),n={};n[l("destroy")]=()=>{this.observer.disconnect(),this.ui.remove()},this.ui=e.div({attributes:{draggable:!0},style:{left:a.right+10+"px",top:a.top+window.pageYOffset+"px"},data:{id:this.key},classNames:[i("prefix")],events:n}),p(this,r),this.observer=new MutationObserver((()=>this.trigger(new Event(l("newWord"))))),this.observer.observe(r,{childList:!0}),this.registerPlugins=t=>{for(const[e,s]of Object.entries(t))this.registry.set(e,new s(this));return this},e.$("body").append(this.ui)}}(e.$("#pz-game-root")).registerPlugins(k)}();
